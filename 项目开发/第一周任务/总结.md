###  用例图

![image-20200410083440457](https://raw.githubusercontent.com/a11enyang/Picture/master/img/image-20200410083440457.png)

### 用例列表

| 序号 | 用例名称           |
| ---- | ------------------ |
| 1    | 登录               |
| 2    | 个人信息管理       |
| 3    | 票务查询           |
| 4    | 订票管理           |
| 5    | 退签办理           |
| 6    | 改签办理           |
| 7    | 订单管理           |
| 8    | 票务管理           |
| 9    | 新闻广告管理       |
| 10   | 用户权限（黑名单） |
| 11   | 系统日志           |
| 12   | 数据分析           |



### 业务规则

| 序号 | 描述                                                         | 采取的措施 | 评论 |
| ---- | ------------------------------------------------------------ | ---------- | ---- |
| 1    | 用户所订车次或改签车次的对应票种有余票                       |            |      |
| 2    | 所选乘车人都应该是合法用户；                                 |            |      |
| 3    | 票务管理系统优先根据用户的座位选择进行排座，多人订票尽量保证座位号是连着的； |            |      |
| 4    | 退票、改签处理必须优先参考国家发布的临时政策，如疫情期间的火车票政策； |            |      |
| 5    | 票务管理端资金充足；                                         |            |      |
| 6    | 用户改签时只能改签符合改签规定的车次                         |            |      |
| 7    | 账号在数据库中存在并有效                                     |            |      |
| 8    | 密码与相应的账号匹配                                         |            |      |
| 9    | 身份信息有效并且在当前用户的常用乘车人中不存在               |            |      |
| 10   | 服务器没有超载                                               |            |      |
| 11   | 用户的资金充足                                               |            |      |
| 12   | 广告格式正确                                                 |            |      |



### 详述用例

| 序号     | 1                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 登录                                                         |
| 描述     | 用户或售票端操作人员进行登录操作                             |
| 输入     | 账号和密码                                                   |
| 参与者   | 用户、售票端管理员、系统管理员                               |
| 用例关系 |                                                              |
| 前置条件 | 执行者进入登录界面                                           |
| 基本流程 | (1)使用者输入账号和密码并提交信息 （2）用户校验 【业务规则7 业务规则8】 （3）根据校验结果，拒绝或允许用户登录，结束用例 |
| 后置条件 | 登录成功，跳转主页面 或 显示登陆失败                         |

| 序号     | 2                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 个人信息管理                                                 |
| 描述     | 管理用户个人信息，包括常用乘车人的管理信息                   |
| 输入     |                                                              |
| 参与者   | 用户                                                         |
| 用例关系 | 在用户正确执行登录用例后进行                                 |
| 前置条件 | 正确登录                                                     |
| 基本流程 | （1）查看用户个人信息 （2）更改用户个人信息 （3）新增个人用户【业务规则9】 |
| 后置条件 |                                                              |



| 序号     | 3                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 票务查询                                                     |
| 描述     | 用户查询票务信息                                             |
| 输入     | 起点 目的地                                                  |
| 参与者   | 用户                                                         |
| 用例关系 |                                                              |
| 前置条件 |                                                              |
| 基本流程 | （1）用户输入并提交日期，起始地目的地等信息 （2）数据库查询 （3）显示查询到的列车次，结束用例 |
| 后置条件 |                                                              |



| 序号     | 4                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 订票办理                                                     |
| 描述     | 需要订票的用户在用户端进行的订票操作                         |
| 输入     | 订票用户的所订的票务信息（包括车次、时间、起发站终止站）以及自身的乘车人个数和乘车人信息 |
| 输出     | 成功则生成订单信息，失败输出失败提示                         |
| 参与者   | 订票用户，票务管理端                                         |
| 用例关系 | 本用例需要在用例3-票务查询后方能进行，此外，本用例是用例5-退票管理、用例6-改签办理、用例7-订单管理的前提用例。 |
| 前置条件 | 票务查询过程顺利，订票用户身份合法，所订的车次有余票，订票用户余额足够支付票务费用，订票管理端运行正常 |
| 基本流程 | 1.      订票用户经过用例3-票务查询，查询到所乘车次的票务信息。  2.      订票用户选择对应车次，选择票种。【业务规则1】  3.      订票用户添加乘车人。【业务规则#2】  4.      订票用户选座（ABCEF）。  5.      票务管理系统为用户调配座位，同时更新票务信息。订票用户确认订单。【业务规则#3】   6.      订票用户支付订单，从该用户余额划去金额，金额流入票务管理端账户。【业务规则#4】 |
| 后置条件 | 票务管理端实时更新票务信息，订票用户的订单信息及时更新，资金迅速转移 |



| 序号     | 5                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 退票办理                                                     |
| 描述     | 已经订完票的用户在此处取消自己的订单，票务管理端返还用户订票费用 |
| 输入     | 订票用户对应想取消的订单信息                                 |
| 输出     | 若用户订单信息符合退票条件，票务管理端将作废原有订单，按照退票规定返还对应金额，否则将显示不符合退票条件不予处理。 |
| 参与者   | 参与者                                                       |
| 用例关系 | 本用例必须在用例4-订票办理的基础上进行                       |
| 前置条件 | 用户身份合法，当前订单信息合法，当前订单信息符合退票条件，票务管理端运行正常，票务管理端能够进行正常的资金流动 |
| 基本流程 | 1.      用户进入订单信息界面选取对应订单，点击退票。【业务规则2】  2.      票务管理端读取订单信息，根据相关退票规定决定是否许可退票并计算对应金额，将处理结果发送给用户。【业务规则5】  3.      若订单信息符合退票规定，用户看到自己退票的详细信息，包括票务信息和所退金额，否则看到系统发来的拒绝退票的信息。  4.      用户点击确认退票，之前的订单作废，对应车次票务信息更新，票务管理端返还对应金额【业务规则6】 |
| 后置条件 | 原有订单立刻作废，票务管理端及时更新票务信息，退票对应金额能迅速转到订票用户的个人账户 |



| 序号     | 6                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 改签办理                                                     |
| 描述     | 已经完成订票的用户因为车次本身或者是行程安排改变的原因需要更改之前的订单 |
| 输入     | 用户原先的订票信息和用户新提交的改签信息                     |
| 输出     | 若输入信息符合改签相关规定，系统将更新用户订单，否则提示用户改签失败 |
| 参与者   | 需要改签的用户，票务管理端                                   |
| 用例关系 | 本用例必须在用例4-订票办理的基础上进行                       |
| 前置条件 | 用户身份合法，当前订单信息合法，当前订单信息符合改签条件，用户提交的改签信息合法，改签对应车次有余座，若有手续费用户余额足够支付手续费，票务管理端运行正常 |
| 基本流程 | 用户进入订单信息界面选取对应订单，点击改签。【业务规则2】  **2.**     票务管理端读取订单信息，根据订单信息决定是否处理本次改签请求并将处理结果发送给用户。【业务规则5】  3.      若订单信息符合改签规定，用户将在改签页面选择改签的日期，点击查询并选择要改的车次，重新选择改签的票种。若不符合规定，则系统提示改签请求违反规定不予受理。【业务规则7】  4.      用户确认改签信息，票务管理系统为用户调配座位，同时更新票务信息。订票用户确认改签订单。【业务规则1】  5.      如果有相关的手续费以及用户因为修改票种造成的费用，用户将要支付对应订单，用户余额将被划去并流入票务管理端账户。【业务规则4】 |
| 后置条件 | 原有订单信息立刻作废，生成新的改签订单，票务管理端及时更新原车次和改签车次的票务信息，资金流动顺利 |



| 序号     | 7                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 订单管理                                                     |
| 描述     | 用户查看历史订单记录，生成订单以及结账                       |
| 输入     |                                                              |
| 参与者   | 用户                                                         |
| 用例关系 | 其中生成订单需在用例订票办理成功的前提下进行，结账在用例生成订单后进行 |
| 前置条件 | 用户成功登陆                                                 |
| 基本流程 | （1）用户成功登陆（2） 进入订单管理功能模块 （3）进行订单管理的相关操作（3.1） 查看历史订单，显示历史的订单记录（3.2） 生成订单，在选择了相应的票后生成订单（3.3） 结账，对生成的订单进行支付    【业务规则11】 |
| 后置条件 | （1）订单管理(查看历史订单、生成订单、结账)相应的操作成功 （2）显示订单管理(查看历史订单、生成订单、结账)失败的错误信息 |



| 序号     | 8                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 票务管理                                                     |
| 描述     | 售票端后台对用户的票务请求(订票、退签、改签)进行响应         |
| 输入     |                                                              |
| 参与者   | 售票端后台                                                   |
| 用例关系 | 本用例需在用例订票办理、退票办理、改签办理完成的前提下进行   |
| 前置条件 | 售票端后台运行正常，服务器未出错                             |
| 基本流程 | （1） 订票管理（1.1）用户发出订票请求（1.2） 后台核对是否有多余的票    【业务规则2】 （1.3）  有余票则响应用户请求(购票成功)，同时更新数据库 （2）退签管理（2.1） 用户发出退签请求（2.2） 核对退签信息（2.3） 响应用户请求，同时更新数据库 （3）改签管理（3.1） 用户发出改签请求（3.2） 后台检索是否有改签的余票    【业务规则11】（3.3） 有余票则响应用户请求(改签成功)，同时更新数据库 |
| 后置条件 | （1）票务管理操作(订票、退签、改签)成功信息返回，有余票则订票和改签成功，否则订票和改签失败 （2）显示服务器过忙(未响应)  或网络繁忙的错误信息 |



| 序号     | 9                                                            |
| -------- | ------------------------------------------------------------ |
| 名称     | 新闻广告管理                                                 |
| 描述     | 售票端操作人员后台操作发布广告，或者删除广告                 |
| 输入     |                                                              |
| 参与者   | 售票端操作人员                                               |
| 用例关系 |                                                              |
| 前置条件 | 售票端操作人员成功登陆                                       |
| 基本流程 | （1）操作人员成功登陆 （2）进入广告管理功能模块 （3）显示广告管理的操作成功(发布广告、删除广告)，结束用例 【业务规则12】 |
| 后置条件 | （1）发布或删除广告成功 （2）显示广告发布或删除失败的错误信息 |



| 序号     | 10                                                           |
| -------- | ------------------------------------------------------------ |
| 名称     | 用户权限管理                                                 |
| 描述     | 限制某些特定用户的权限，设置黑名单，禁止某些用户的登录使用   |
| 输入     | 用户的身份证或者账号                                         |
| 参与者   | 系统管理员 用户                                              |
| 用例关系 |                                                              |
| 前置条件 | 系统管理员登录                                               |
| 基本流程 | （1）系统管理员登录后台管理页面【业务规则7 8】 （2）系统管理员添加黑名单 （3）保存黑名单 |
| 后置条件 |                                                              |



| 序号     | 11                                                           |
| -------- | ------------------------------------------------------------ |
| 名称     | 系统日志                                                     |
| 描述     | 查看系统运行状态，查看系统产生的日志                         |
| 输入     |                                                              |
| 参与者   | 系统管理员                                                   |
| 用例关系 |                                                              |
| 前置条件 |                                                              |
| 基本流程 | （1）系统管理员登录后台管理页面【业务规则7 8】（2）.系统管理员查看系统日志情况 |
| 后置条件 |                                                              |

| 序号     | 12                                                           |
| -------- | ------------------------------------------------------------ |
| 名称     | 数据分析                                                     |
| 描述     | 查看系统运行的数据情况                                       |
| 输入     |                                                              |
| 参与者   | 系统管理员                                                   |
| 用例关系 |                                                              |
| 前置条件 |                                                              |
| 基本流程 | （1）系统管理员登录后台管理页面 （2）系统管理员对系统状况进行查看 |
| 后置条件 |                                                              |

